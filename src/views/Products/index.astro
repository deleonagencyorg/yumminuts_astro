---
// src/components/pages/ProductsPage.astro
import { t } from '../../i18n/i18n';
import type { Locale } from '../../i18n/i18n';
import { getLocale } from '../../i18n/i18n';
import './styles.css';
import Carousel from '../../components/common/Carousel/index.astro';
import ProductsWithFilter from '../../components/common/ProductsWithFilter/index.astro';
import Discover from '../../components/common/Discover/index.astro';
import categoriesConfig from '../../config/categories.json';
import Breadcrumb from '../../components/common/Breadcrumb/Breadcrumb.astro';


const currentLang = getLocale();
const products = t('items', { namespace: 'products', locale: currentLang });
const commonAssets = t('home.slider', { namespace: 'products', locale: currentLang }) || [];
const slides = commonAssets;
const discoverAssets = t('assets.discoverSection', { namespace: 'common', locale: currentLang }) || {};

// Categorías centralizadas (mismas que usa ProductsWithFilter)
const uniqueCategories = (categoriesConfig.categories || []).map((c: any) => c.key);
---

<main class="w-full flex flex-col items-center justify-center mt-0">
  <div class="w-full reveal-on-scroll">
    <Carousel slides={slides} />
  </div>
  <div class="container mx-auto px-4 reveal-on-scroll">
    <Breadcrumb bgColor="bg-transparent" textColor="text-primary" hoverColor="hover:text-primary" />
  </div>

  <!-- New Products with Filter Component -->
  <div class="reveal-on-scroll -mt-16">
    <ProductsWithFilter  showAllProducts={true} />
  </div>

  <section id="discover" class="w-full bg-white py-2 reveal-on-scroll">
    <Discover title={discoverAssets.title} images={discoverAssets.images || []} />
  </section>
</main>

<script>
  // Fix para las imágenes que no cargan
  document.addEventListener('DOMContentLoaded', () => {
    const images = document.querySelectorAll('img');
    images.forEach(img => {
      img.addEventListener('error', function() {
        this.src = '/images/products/placeholder.jpg';
      });
    });
  });
</script>

