---
// src/views/Health/index.astro
import { t } from '../../i18n/i18n';
import type { Locale } from '../../i18n/i18n';
import { getLocale } from '../../i18n/i18n';
import './styles.css';
import Carousel from '../../components/common/Carousel/index.astro';
import HealthInfoSection from '../../components/common/HealthInfoSection.astro';
import Discover from '../../components/common/Discover/index.astro';
import VideoSection from '../../components/common/VideoSection/index.astro';

const currentLang = getLocale();
const healthBenefits = t('benefits', { namespace: 'health', locale: currentLang });
const healthHome = t('assets.healthPage', { namespace: 'common', locale: currentLang }) || {};
const healthCategories = t('categories', { namespace: 'health', locale: currentLang });
const healthSlider = t('assets.healthPage.slider', { namespace: 'common', locale: currentLang }) || [];
const slides = healthSlider;
const discoverAssets = t('assets.discoverSection', { namespace: 'common', locale: currentLang }) || {};
const healthInfoAssets = t('assets.healthInfo', { namespace: 'common', locale: currentLang }) || [];

// Get video section data
const videoSectionData = t('assets.healthPage.videosSection', { namespace: 'common', locale: currentLang }) || {};
const videosData = t('assets.healthPage.videos', { namespace: 'common', locale: currentLang }) || [];

// Get unique health categories
const uniqueCategories = Object.keys(healthCategories || {});
console.log('Health home:', healthHome.title);
---

<main class="w-full flex flex-col items-center justify-center mt-0">
  <!-- Slider Section with mask -->
  <div class="relative w-full overflow-hidden max-w-[100vw] h-auto aspect-[1/1] md:aspect-[16/9] lg:h-[80vh]">
    <div class="relative z-0 w-full md:w-[100%] md:ml-auto md:h-full h-[95vh] md:flex md:items-center md:justify-center">
      <Carousel slides={slides} />
    </div>
  </div>

  <!-- Health Benefits Section -->
  <section class="w-full bg-white py-16">
    <div class="box-border content-stretch flex gap-[20px] items-center px-[90px] py-0 relative w-full">
      <div class="basis-0 content-stretch flex flex-col gap-[50px] grow items-start justify-center leading-[0] min-h-px min-w-px not-italic relative shrink-0">
        <div class="font-bold relative shrink-0 text-black text-[55px] tracking-[-2px] w-full text-sans">
          <p class="leading-[65px]">{healthHome?.title || 'Activa tu mente y cuerpo con Yummi Nuts'}</p>
        </div>
        <div class="font-normal relative shrink-0 text-[25px] text-gray tracking-[5px] w-full" >
          <p class="leading-[60px]">{healthHome?.description || 'Lorem Ipsum Dolor It'}</p>
        </div>
      </div>
      <div class="content-stretch flex flex-col gap-[27.972px] items-start relative shrink-0 w-[620px]">
        <div class="h-[615.964px] overflow-clip relative shrink-0 w-[620.178px]">
          <div class="absolute inset-0">
            <img alt="Yummi Nuts Health" class="block max-w-none size-full object-cover" height="615.964" src={healthHome?.image || 'https://snack.yummiespromociones.com/yumminuts/home-salud.png'} width="620.178" />
          </div>
          <div class="absolute content-stretch flex items-center justify-between translate-x-[-50%] translate-y-[-50%] w-[620.18px]" style="top: calc(50% + 0.485px); left: calc(50% + 0.001px);">
            <div class="flex items-center justify-center relative shrink-0">
              <div class="flex-none rotate-[180deg]">
                <div class="opacity-60 hover:opacity-100 transition-opacity cursor-pointer relative size-[50.935px]">
                  <div class="absolute bg-primary left-0 rounded-[8.103px] size-[50.935px] top-0">
                    <div aria-hidden="true" class="absolute border-[0.796px] border-gray border-solid inset-0 pointer-events-none rounded-[8.103px]"></div>
                  </div>
                  <div class="absolute flex h-[20.828px] items-center justify-center top-1/2 translate-x-[-50%] translate-y-[-50%] w-[20.828px]" style="left: calc(50% - 0.004px);">
                    <div class="flex-none rotate-[270deg]">
                      <div class="relative size-[20.837px]">
                        <svg class="size-full text-white" fill="currentColor" viewBox="0 0 24 24">
                          <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
                        </svg>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="flex items-center justify-center relative shrink-0">
              <div class="flex-none scale-y-[-100%]">
                <div class="relative size-[50.935px] cursor-pointer hover:scale-105 transition-transform">
                  <div class="absolute backdrop-blur-[11.016px] backdrop-filter bg-primary left-0 rounded-[11.938px] size-[50.935px] top-0">
                    <div aria-hidden="true" class="absolute border-secondary border-[0.796px] border-solid inset-0 pointer-events-none rounded-[11.938px]"></div>
                  </div>
                  <div class="absolute flex h-[20.828px] items-center justify-center top-1/2 translate-x-[-50%] translate-y-[-50%] w-[20.828px]" style="left: calc(50% - 0.004px);">
                    <div class="flex-none rotate-[270deg]">
                      <div class="relative size-[20.837px]">
                        <svg class="size-full text-white" fill="currentColor" viewBox="0 0 24 24">
                          <path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
                        </svg>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Video Section -->
  <VideoSection 
    title={videoSectionData?.title || 'Tips para mantener tu cuerpo siempre saludable'}
    description={videoSectionData?.description || 'Explora más sobre Yummi Nuts a través de nuestros videos.'}
    videos={videosData}
  />

  <!-- Discover Section -->
  <section id="discover" class="w-full bg-white py-16">
    <Discover title={discoverAssets.title} images={discoverAssets.images || []} />
  </section>
</main>

<script>
  // Fix for images that don't load
  document.addEventListener('DOMContentLoaded', () => {
    const images = document.querySelectorAll('img');
    images.forEach(img => {
      img.addEventListener('error', function() {
        this.src = '/images/placeholder.jpg';
      });
    });
    
    // Add animation to health benefit cards
    const benefitCards = document.querySelectorAll('.health-benefit-card');
    
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('animate-fadeInUp');
        }
      });
    });
    
    benefitCards.forEach(card => {
      observer.observe(card);
    });
  });
</script>
