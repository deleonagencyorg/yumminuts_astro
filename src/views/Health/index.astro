---
// src/views/Health/index.astro
import { t } from '../../i18n/i18n';
import type { Locale } from '../../i18n/i18n';
import { getLocale } from '../../i18n/i18n';
import './styles.css';
import Carousel from '../../components/common/Carousel/index.astro';
import HealthInfoSection from '../../components/common/HealthInfoSection.astro';
import Discover from '../../components/common/Discover/index.astro';
import VideoSection from '../../components/common/VideoSection/index.astro';
import LazyImage from '../../components/common/LazyImage.astro';
import Breadcrumb from '../../components/common/Breadcrumb/Breadcrumb.astro';

const currentLang = getLocale();
const healthBenefits = t('benefits', { namespace: 'health', locale: currentLang });
const healthHome = t('assets.healthPage', { namespace: 'common', locale: currentLang }) || {};
const healthCategories = t('categories', { namespace: 'health', locale: currentLang });
const healthSlider = t('assets.healthPage.slider', { namespace: 'common', locale: currentLang }) || [];
const slides = healthSlider;
const discoverAssets = t('assets.discoverSection', { namespace: 'common', locale: currentLang }) || {};
const healthInfoAssets = t('assets.healthInfo', { namespace: 'common', locale: currentLang }) || [];

// Get video section data
const videoSectionData = t('assets.healthPage.videosSection', { namespace: 'common', locale: currentLang }) || {};
const videosData = t('assets.healthPage.videos', { namespace: 'common', locale: currentLang }) || [];

// Get unique health categories
const uniqueCategories = Object.keys(healthCategories || {});
console.log('Health home:', healthHome.title);
---

<main class="w-full flex flex-col items-center justify-center mt-0">
  <div class="container mx-auto px-4">
    <Breadcrumb bgColor="bg-transparent" textColor="text-primary" hoverColor="hover:text-primary" />
  </div>
  <!-- Slider Section centered at 80% width (same as Products) -->
  <div class="w-full flex items-center justify-center text-center">
    <div class="w-[80vw] mx-auto">
      <Carousel slides={slides} />
    </div>
  </div>

  <!-- Health Benefits Section -->
  <section class="container mx-auto px-4 pt-10 md:pt-14 pb-8 md:pb-12">
    <div class="flex flex-col md:flex-row items-center gap-8 md:gap-12">
      <!-- Left: Title + Description -->
      <div class="w-full md:w-1/2 text-center md:text-left">
        <h1 class="font-heading text-black text-3xl md:text-5xl font-bold mb-3">{healthHome?.title || 'Activa tu mente y cuerpo con Yummi Nuts'}</h1>
        <p class="text-gray-600 text-base md:text-lg leading-relaxed">{currentLang === 'es' ? 'Sabemos que cuidar tu cuerpo no es una moda, es un estilo de vida. Por eso Yummi Nuts te comparte información importante sobre tu salud y algunos tips para que sigas cuidando tu cuerpo y disfrutando tus semillas favoritas.' : 'We know that taking care of your body is not a trend, it is a lifestyle. That is why Yummi Nuts shares important information about your health and some tips to continue taking care of your body and enjoying your favorite seeds.' }</p>
      </div>

      <!-- Right: Simple responsive image -->
      <div class="w-full md:w-1/2">
        <div class="relative overflow-hidden rounded-2xl aspect-[4/3]">
          <LazyImage alt="Yummi Nuts Health" class="w-full h-full object-cover" src={healthHome?.image || 'https://snack.yummiespromociones.com/yumminuts/home-salud.png'} />
        </div>
      </div>
    </div>
  </section>

  <!-- Video Section -->
<section id="videos" class="container mx-auto px-4 pt-4 md:pt-6 pb-0">
  <VideoSection 
    title={videoSectionData?.title || 'Tips para mantener tu cuerpo siempre saludable'}
    description={videoSectionData?.description || 'Explora más sobre Yummi Nuts a través de nuestros videos.'}
    videos={videosData}
  />
</section>

  <!-- Discover Section -->
  <section id="discover" class="container mx-auto px-4 py-10 md:py-14">
    <Discover title={discoverAssets.title} images={discoverAssets.images || []} />
  </section>
</main>

<script>
  // Fix for images that don't load
  document.addEventListener('DOMContentLoaded', () => {
    const images = document.querySelectorAll('img');
    images.forEach(img => {
      img.addEventListener('error', function() {
        this.src = '/images/placeholder.jpg';
      });
    });
    
    // Add animation to health benefit cards
    const benefitCards = document.querySelectorAll('.health-benefit-card');
    
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('animate-fadeInUp');
        }
      });
    });
    
    benefitCards.forEach(card => {
      observer.observe(card);
    });
  });
</script>
